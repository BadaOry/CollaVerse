<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  


<mapper namespace="com.collaverse.mvc.collections.model.dao.CollectionsMapper">

	<resultMap type="com.collaverse.mvc.member.model.vo.Member" id="memberResultMap">
		<id property="no" column="MEMBER_NO"/>
		<result property="role" column="MEMBER_ROLE"/>
		<result property="id" column="ID"/>
		<result property="password" column="PASSWORD"/>
		<result property="email" column="EMAIL"/>
		<result property="phone" column="PHONE"/>
		<result property="nickname" column="NICKNAME"/>
		<result property="profile_img" column="PROFILE_IMG"/>
		<result property="business_no" column="BUSINESS_NO"/>
		<result property="business_name" column="BUSINESS_NAME"/>
		<result property="enrollDate" column="ENROLL_DATE"/>
		<result property="modifyDate" column="MODIFY_DATE"/>
		<result property="status" column="MEMBER_STATUS"/>
		<result property="age" column="MEMBER_AGE"/>
		<result property="gender" column="MEMBER_GENDER"/>
	</resultMap>
	
	<resultMap type="com.collaverse.mvc.collections.model.vo.Collections" id="listResultMap">
		<result property="id" column="ID"/>
		<result property="nickname" column="NICKNAME"/>
		<result property="profile_img" column="PROFILE_IMG"/>
	</resultMap>
		
		
	<select id="getAllUserIdList" resultMap="listResultMap" resultType="arrayList">
		SELECT ID, NICKNAME, PROFILE_IMG
		FROM MEMBER
		WHERE MEMBER_ROLE IN ('개인', '기업')
	</select>
		
		 
	<select id="findUserById" parameterType="String" resultMap="listResultMap" resultType="map">
		SELECT ID, NICKNAME, PROFILE_IMG
		FROM MEMBER 
		WHERE ID LIKE '%' || #{ keyword } || '%' 
	</select>
	
	
	<select id="findUserByNickname" parameterType="String" resultMap="listResultMap" resultType="arrayList">
		SELECT ID, NICKNAME, PROFILE_IMG
		FROM MEMBER 
		WHERE NICKNAME LIKE '%' || #{ keyword } || '%' 
	</select>
	
	<select id="findBrandUserById" parameterType="String" resultMap="listResultMap" resultType="map">
		SELECT ID, NICKNAME, PROFILE_IMG
		FROM MEMBER 
		WHERE ID LIKE '%' || #{ keyword } || '%' 
			AND MEMBER_ROLE = '기업'
	</select>
	
	<select id="findBrandUserByNickname" parameterType="String" resultMap="listResultMap" resultType="arrayList">
		SELECT ID, NICKNAME, PROFILE_IMG
		FROM MEMBER 
		WHERE NICKNAME LIKE '%' || #{ keyword } || '%' 
			AND MEMBER_ROLE = '기업'
	</select>
	
	<select id="findOnlyUserById" parameterType="String" resultMap="listResultMap" resultType="map">
		SELECT ID, NICKNAME, PROFILE_IMG
		FROM MEMBER 
		WHERE ID LIKE '%' || #{ keyword } || '%' 
			AND MEMBER_ROLE = '개인'
	</select>
	
	<select id="finOnlyUserByNickname" parameterType="String" resultMap="listResultMap" resultType="arrayList">
		SELECT ID, NICKNAME, PROFILE_IMG
		FROM MEMBER 
		WHERE NICKNAME LIKE '%' || #{ keyword } || '%' 
			AND MEMBER_ROLE = '개인'
	</select>
	
	
	<select id="getuserListByFollower" resultMap="listResultMap" resultType="arrayList">
		SELECT TO_MEM_NO, ROWNUM 
		FROM (
			SELECT COUNT(*), TO_MEM_NO
			FROM FOLLOWER
			GROUP BY TO_MEM_NO
			ORDER BY COUNT(*) DESC )
		WHERE ROWNUM BETWEEN 1 AND 100
	</select>
	
	<select id="getuserListByFollowerId" parameterType="arrayList" resultMap="listResultMap" resultType="arrayList">
		SELECT ID, NICKNAME, PROFILE_IMG
		FROM MEMBER
		WHERE MEMBER_NO IN #{ userListByFollowerMemNo }
	</select>
	
	<select id="getBrandUserIdList" resultMap="listResultMap" resultType="arrayList">
		SELECT ID, NICKNAME, PROFILE_IMG
		FROM MEMBER
		WHERE MEMBER_ROLE IN ('기업')
	</select>
	
	<select id="getOnlyUserIdList" resultMap="listResultMap" resultType="arrayList">
		SELECT ID, NICKNAME, PROFILE_IMG
		FROM MEMBER
		WHERE MEMBER_ROLE IN ('개인')
	</select>
	
</mapper>
